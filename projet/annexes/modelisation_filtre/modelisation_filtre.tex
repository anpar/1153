\documentclass{article}

\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[francais]{babel}
\usepackage{circuitikz}
\usepackage[squaren, Gray]{SIunits}
\usepackage{sistyle}
\usepackage[autolanguage]{numprint}
\usepackage{PGFPlots}

\begin{document}

\section{Modélisation des filtres passe-haut et passe-bas}
Dans cette section, nous allons expliquer la méthode que nous avons
utiliser pour trouver une expression analytique de la tension de sortie 
dans un filtre passe-bas, la démarche étant la même pour le filtre passe-bas.

Nous avons en réalité utiliser deux méthodes différentes qui, heureusement, 
aboutissent à la même solution. La première méthode utilise ce que nous
avons appris au premier quadrimestre concernant les équations différentielles.
Cette méthode est plus longue et plus compliquée que la deuxième, c'est pourquoi
nous ne la décrirons pas ici.
La deuxième méthode utilise ce que nous avons appris au deuxième quadrimestre 
concernant les équations différentielles et les complexes. 

\subsection{Le filtre passe-bas}

Soit $V_R$ la tension à travers la résistance $R$, $V_C$ la tension à travers
le condensateur $C$, $V_{in}$ la tension d'entrée et $V_{out}$ la tension de
sortie du filtre.

\begin{center}
	\begin{circuitikz}
		\draw (0,0) node[ocirc] (A);
		\draw (0,0) to [R=$R$] (2,0);
		\draw (2,0) to [short] (4,0);
		\draw (4,0) node[ocirc] (C);
		\draw (2,0) to [C=$C$] (2,-2);
		\draw (2,-2) to [short] (4,-2);
		\draw (4,-2) node[ocirc] (D);
		\draw (0,-2) to [short] (2,-2);
		\draw (0,-2) node[ocirc] (B);
		\draw (A) to[open, v=$V_ {in}$] (B);
		\draw (C) to[open, v=$V_{out}$] (D);
	\end{circuitikz}
\end{center}

Sur le circuit ci-dessus, on peut utiliser la loi des tensions de Kirchhoff :

$$V_{in} = V_R + V_{out}$$

On note $V$ l'amplitude de la tension d'entrée sinusoïdale, $i(t)$ est le courant
en fonction du temps : 

$$V \cdot \cos (\omega t) = R \cdot i(t) + V_C$$

Or, le courant $i(t)$ à travers un condensateur est donné par $C \frac{dV_C}{dt}$, 
l'équation devient alors une équation différentielle en la fonction inconnue $V_C (t)$ :

$$V \cdot \cos (\omega t) = RC\frac{dV_C}{dt}  + V_C$$

On peut réecrire cette équation de la manière suivante, où $y = V_C(t)$ :

$$RCy' + y = V \cdot \cos (\omega t)$$

Cette équation va être la base de la méthode qui suit. On va également utiliser 
la condition initiale suivante :

$$y(0) = 0$$

\subsubsection{Résolution de l'équation différentielle}

On sait que $\cos (\omega t)$ est égale à la partie réelle de l'exponentielle
complexe $e^{\omega i t}$. On réecrit alors l'équation différentielle de la
manière suivante :

$$RCy' + y = V \cdot e^{\omega i t}$$

Comme pour toute équation différentielle linéaire non-homogène, nous allons travailler
en deux étapes :

\paragraph{Recherche de la solution homogène}

Le polynôme caractéristique de l'équation homogène est :

$$RC \cdot x + 1 = 0$$

On a alors $x = \frac{-1}{RC}$ comme racine, et on trouve donc comme solution homogène :

$$y_h(t) = A \cdot e^{\frac{-t}{RC}}$$

Où $A$ est une constante appartenant à l'ensemble des réels. % A confirmer, j'ai un doute.

\paragraph{Recherche de la solution particulière}

La solution particulière qu'on recherche est de la forme :

$$y_p(t) = \alpha \cdot e^{\omega i t}$$

Il nous reste donc à déterminer la constante complexe $\alpha$. Pour ce faire,
nous injections dans l'équation de de départ $y_p(t)$ et sa dérivée seconde. On
trouve alors :

$$\alpha = \frac{V(1-RC\omega i)}{1+R^2C^2\omega^2}$$

La solution particulière est donc :

$$\frac{V(1-RC\omega i)}{1+R^2C^2\omega^2} \cdot e^{\omega i t}$$

\paragraph{Solution complète}

La solution finale $y(t)$ est égale à $y_h(t) + y_p(t)$ :

$$y(t) = A \cdot e^{\frac{-t}{RC}} + \frac{V(1-RC\omega i)}{1+R^2C^2\omega^2} \cdot e^{\omega i t}$$

En retransformant ensuite l'exponentielle complexe en sa forme trigonométrique et en ne
gardant que la partie réelle, on trouve :

$$y(t) = V_C(t) = \frac{V(\cos (\omega t) + RC\omega \sin (\omega t))}{1 + \omega^2R^2C^2} + A \cdot e^{\frac{-t}{RC}}$$

\paragraph{Elimination de la constante}

Il ne nous reste plus qu'à éliminer la constante $A$ en utilisant la condition initiale.
On trouve enfin :

$$A = -\frac{V}{1 + \omega^2R^2C^2}$$                         

\paragraph{Conclusion}

La tension de sortie en fonction du temps est donc donnée par :

$$\fbox{V_{out} = \frac{V}{1 + \omega^2R^2C^2} \cdot (\cos (\omega t) + RC\omega \sin (\omega t) - e^{\frac{-t}{RC}})}$$

\subsubsection{Vérification des résultats}

Une première vérification que l'on peut faire est de vérifier que $V_{out}$ tend vers 0
lorsque $\omega$ tend vers l'infini. C'est bien le cas ici puisqu'on a $\omega^2$ au dénominateur.

On peut ensuite comparer le graphe de l'expression analytique de $V_{out}$ avec le graphe donné
par un logiciel de simulation de circuit électronique comme LTSpiceIV.

\begin{center}
\begin{tikzpicture}[>=stealth]
    \begin{axis}[
        xmin=0,xmax=6,
        ymin=-5,ymax=5,
        axis x line=middle,
        axis y line=middle,
        axis line style=->,
        xlabel={$x$},
        ylabel={$y$},
        ]
        \addplot[no marks,black,-] expression[domain=0:25,samples=1000]
				{(15)/(1 + 628.32^2 * 10000^2 * (0.000001)^2) * (cos(628.32*x) + 10000*628.32*(0.000001)*sin(628.32*x) - 2.718^(-x/(10000*0.000001)))} 
                    node[pos=0.65,anchor=south west]{$$}; 
    \end{axis}
\end{tikzpicture}
\end{center}

% Le graphique obtenu (avec LaTeX en tout cas), ne correspond pas à ce que j'ai avec LTSpiceIV

\subsection{Le filtre passe-haut}

Soit $V_R$ la tension à travers la résistance $R$, $V_C$ la tension à travers
le condensateur $C$, $V_{in}$ la tension d'entrée et $V_{out}$ la tension de
sortie du filtre.

\begin{center}
	\begin{circuitikz}
		\draw (0,0) node[ocirc] (A);
		\draw (0,0) to [C=$C$] (2,0);
		\draw (2,0) to [short] (4,0);
		\draw (4,0) node[ocirc] (C);
		\draw (2,0) to [R=$R$] (2,-2);
		\draw (2,-2) to [short] (4,-2);
		\draw (4,-2) node[ocirc] (D);
		\draw (0,-2) to [short] (2,-2);
		\draw (0,-2) node[ocirc] (B);
		\draw (A) to[open, v=$V_ {in}$] (B);
		\draw (C) to[open, v=$V_{out}$] (D);
	\end{circuitikz}
\end{center}

La loi des tensions de Kirchhoff donne la même équation que pour le filtre passe-bas :

$$V_{in} = V_R + V_C$$

Cette fois, $V_{out} = V_R$. Or on connait déjà $V_C$ que l'on a calculé dans
le section précédente. On a alors simplement :

$$V_R = V_{in} - V_C$$

$$\fbox{V_{out} = \frac{V}{1 + \omega^2R^2C^2} \cdot (\omega^2R^2C^2\cos (\omega t) - RC\omega \sin (\omega t) + e^{-\frac{t}{RC}})}$$

\subsubsection{Vérification des résultats}

Pour le filtre passe-haut, on va cette fois vérifier que lorsque $\omega$ tend vers 0, on a
$V_{out}$ qui tend vers 0 également. % C'est ce qu'on devrait avoir, mais on obtient pas vraiment ça...

\end{document}